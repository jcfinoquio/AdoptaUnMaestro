// @ts-nocheck
document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("login-form"),t=document.getElementById("mensaje"),o=document.getElementById("mail"),n=document.getElementById("password"),a=document.getElementById("login-overlay");document.getElementById("cerrar-modal");function i(){a.classList.remove("active"),document.body.classList.remove("modal-overlay"),t.textContent="",e.reset()}document.getElementById("abrir-modal")?.addEventListener("click",(function(){a.classList.add("active"),document.body.classList.add("modal-active")})),document.getElementById("cerrar-modal")?.addEventListener("click",(function(){i()})),a?.addEventListener("click",(function(e){e.target===this&&i()})),e?.addEventListener("submit",(e=>{e.preventDefault();const a=o?.value.trim()||"",d=n?.value||"";return a?(e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))(a)?d?(t.textContent="Iniciando sesión...",t.style.color="blue",void setTimeout((()=>{"usuario@ejemplo.com"===a&&"123456"===d?(t.textContent="¡Login exitoso! ✅",t.style.color="green",setTimeout((()=>{i(),alert("Bienvenido!")}),1e3)):(t.textContent="Credenciales incorrectas. Inténtalo de nuevo.",t.style.color="red")}),1500)):(t.textContent="Por favor, introduce tu contraseña.",void(t.style.color="red")):(t.textContent="El formato del correo electrónico no es válido.",void(t.style.color="red")):(t.textContent="Por favor, introduce tu correo electrónico.",void(t.style.color="red"))})),window.toggleExpand=function(e){const t=e.closest(".job-offer");t&&(t.classList.toggle("expanded"),e.textContent=t.classList.contains("expanded")?"Leer menos":"Leer más")},document.querySelectorAll(".read-more-btn").forEach((e=>{e.addEventListener("click",(function(){window.toggleExpand(this)}))})),document.querySelectorAll(".btn-primary").forEach((e=>{"Postularme"===e.textContent&&e.addEventListener("click",(function(){alert("¡Postulación enviada correctamente!"),this.textContent="Postulado",this.classList.remove("btn-primary"),this.classList.add("btn-success"),this.disabled=!0}))}));document.querySelectorAll("[id^='visitas-']").forEach((e=>{const t=e.id;let o=parseInt(localStorage.getItem(t))||0;o++,localStorage.setItem(t,o),e.textContent=o}));document.querySelectorAll("[id^='contador-likes']").forEach((e=>{const t=e.id.replace("contador-likes",""),o=document.getElementById(`numero-likes${t}`),n=`likes-count${t}`,a=`user-liked${t}`;let i=parseInt(localStorage.getItem(n))||0;o&&(o.textContent=i),"true"===sessionStorage.getItem(a)&&(e.classList.add("clicado"),e.disabled=!0),e.addEventListener("click",(()=>{sessionStorage.getItem(a)||(i++,o.textContent=i,localStorage.setItem(n,i),e.classList.add("clicado"),e.disabled=!0,sessionStorage.setItem(a,"true"))}))}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("rol"),t=document.getElementById("bloqueMaestro"),o=document.getElementById("bloqueCentro"),n=document.getElementById("formacionesContenedor"),a=document.getElementById("btnAddForm"),i=document.getElementById("registroForm");function d(e){"maestro"===e?(t.classList.remove("hidden"),o.classList.add("hidden")):"centro"===e?(o.classList.remove("hidden"),t.classList.add("hidden")):(t.classList.add("hidden"),o.classList.add("hidden"))}e.addEventListener("change",(e=>d(e.target.value)));let l=0;a.addEventListener("click",(function(){l++;const e=l,t=document.createElement("div");t.className="formation-block",t.dataset.index=e,t.innerHTML=`\n          <div style="display:flex;gap:8px;flex-wrap:wrap;">\n            <div style="flex:1 1 45%;">\n              <label>Título</label>\n              <input name="formacion[${e}][titulo]" type="text" placeholder="Título (Ej: Máster en Educación)" />\n            </div>\n            <div style="flex:1 1 45%;">\n              <label>Centro formador</label>\n              <input name="formacion[${e}][centroFormador]" type="text" placeholder="Centro formador" />\n            </div>\n            <div style="flex:1 1 30%;">\n              <label>Año fin</label>\n              <input name="formacion[${e}][anioFin]" type="number" min="1900" max="2100" />\n            </div>\n            <div style="flex:1 1 30%;">\n              <label>Tipo</label>\n              <input name="formacion[${e}][tipoFormacion]" type="text" placeholder="Tipo (FP, Grado...)" />\n            </div>\n          </div>\n          <div style="text-align:right;margin-top:8px;">\n            <button type="button" class="btn-cancel" data-remove="${e}">Eliminar</button>\n          </div>\n        `,n.appendChild(t),t.querySelector("[data-remove]").addEventListener("click",(()=>t.remove()))})),i.addEventListener("submit",(t=>{if(!i.checkValidity())return t.preventDefault(),void i.reportValidity();const o=e.value;if(""===o)return t.preventDefault(),void alert("Selecciona tu rol (Maestro o Centro).");if("maestro"===o){const e=document.getElementById("nombre").value.trim(),o=document.getElementById("apellidos").value.trim();if(!e||!o)return t.preventDefault(),void alert("Para registrarte como Maestro, indica nombre y apellidos.")}})),d(e.value)})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("rol"),t=document.getElementById("bloqueMaestro"),o=document.getElementById("bloqueCentro"),n=document.getElementById("formacionesContenedor"),a=document.getElementById("btnAddForm"),i=document.getElementById("registroForm");e.addEventListener("change",(e=>{return n=e.target.value,t.classList.toggle("hidden","maestro"!==n),void o.classList.toggle("hidden","centro"!==n);var n}));let d=0;a?.addEventListener("click",(()=>{d++;const e=d,t=document.createElement("div");t.className="formation-block",t.innerHTML=`\n          <div class="form-row">\n            <div class="form-group">\n              <label>Título</label>\n              <input name="formacion[${e}][titulo]" type="text" placeholder="Título (Ej: Máster en Educación)" />\n            </div>\n            <div class="form-group">\n              <label>Centro formador</label>\n              <input name="formacion[${e}][centroFormador]" type="text" placeholder="Centro formador" />\n            </div>\n            <div class="form-group">\n              <label>Año fin</label>\n              <input name="formacion[${e}][anioFin]" type="number" min="1900" max="2100" />\n            </div>\n            <div class="form-group">\n              <label>Tipo</label>\n              <input name="formacion[${e}][tipoFormacion]" type="text" placeholder="Tipo (FP, Grado...)" />\n            </div>\n          </div>\n          <div style="text-align:right;margin-top:8px;">\n            <button type="button" class="btn btn-outline" onclick="this.closest('.formation-block').remove()">Eliminar</button>\n          </div>`,n.appendChild(t)})),i.addEventListener("submit",(e=>{i.checkValidity()||(e.preventDefault(),i.reportValidity())}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=[{id:1,nombre:"Colegio San José",provincia:"Sevilla",tipo:"Concertado",ciudad:"Sevilla",telefono:"955 123 456",logo:"https://images.unsplash.com/photo-1562774053-701939374585?w=400&h=300&fit=crop",resumen:"Centro con enfoque STEM y apoyo a la inclusión."},{id:2,nombre:"Escuela La Marina",provincia:"Málaga",tipo:"Concertado",ciudad:"Málaga",telefono:"952 234 567",logo:"https://images.unsplash.com/photo-1588072432836-e10032774350?w=400&h=300&fit=crop",resumen:"Fuerte programa de idiomas y actividades náuticas."},{id:3,nombre:"Colegio Las Acacias",provincia:"Cádiz",tipo:"Privado",ciudad:"Cádiz",telefono:"956 345 678",logo:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=400&h=300&fit=crop",resumen:"Proyecto artístico y cultural consolidado."},{id:4,nombre:"Centro Virgen del Alba",provincia:"Granada",tipo:"Concertado",ciudad:"Granada",telefono:"958 456 789",logo:"https://images.unsplash.com/photo-1546410531-bb4caa6b424d?w=400&h=300&fit=crop",resumen:"Metodologías activas en primaria."},{id:5,nombre:"Colegio Horizonte",provincia:"Córdoba",tipo:"Público",ciudad:"Córdoba",telefono:"957 567 890",logo:"https://images.unsplash.com/photo-1519452635265-7b1fbfd1e4e0?w=400&h=300&fit=crop",resumen:"Enfoque en mejora continua y convivencia."},{id:6,nombre:"Colegio Andalucía",provincia:"Jaén",tipo:"Concertado",ciudad:"Jaén",telefono:"953 678 901",logo:"https://images.unsplash.com/photo-1498243691581-b145c3f54a5a?w=400&h=300&fit=crop",resumen:"Programa de inclusión y proyectos rurales."},{id:7,nombre:"Escuela Nueva Ola",provincia:"Huelva",tipo:"Privado",ciudad:"Huelva",telefono:"959 789 012",logo:"https://images.unsplash.com/photo-1503676260728-1c00da094a0b?w=400&h=300&fit=crop",resumen:"Talleres tecnológicos y deportivos."},{id:8,nombre:"Colegio Alborán",provincia:"Almería",tipo:"Concertado",ciudad:"Almería",telefono:"950 890 123",logo:"https://images.unsplash.com/photo-1568605114967-8130f3a36994?w=400&h=300&fit=crop",resumen:"Apuesta por la naturaleza y huertos escolares."},{id:9,nombre:"Colegio Río Verde",provincia:"Sevilla",tipo:"Público",ciudad:"Dos Hermanas",telefono:"955 901 234",logo:"https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&h=300&fit=crop",resumen:"Proyectos STEAM desde infantil."},{id:10,nombre:"Colegio Mediterráneo",provincia:"Málaga",tipo:"Concertado",ciudad:"Fuengirola",telefono:"952 012 345",logo:"https://images.unsplash.com/photo-1523240795612-9a054b0db644?w=400&h=300&fit=crop",resumen:"Programas bilingües y actividades marinas."},{id:11,nombre:"Colegio San Martín",provincia:"Cádiz",tipo:"Concertado",ciudad:"Jerez",telefono:"956 123 987",logo:"https://images.unsplash.com/photo-1497636577773-f1231844b336?w=400&h=300&fit=crop",resumen:"Trabajo en valores y deporte escolar."},{id:12,nombre:"Colegio Sierra",provincia:"Granada",tipo:"Privado",ciudad:"Motril",telefono:"958 234 876",logo:"https://images.unsplash.com/photo-1434030216411-0b793f4b4173?w=400&h=300&fit=crop",resumen:"Atención a la diversidad y música."},{id:13,nombre:"Colegio Córdoba Centro",provincia:"Córdoba",tipo:"Concertado",ciudad:"Córdoba",telefono:"957 345 765",logo:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=400&h=300&fit=crop",resumen:"Énfasis en tecnología educativa."},{id:14,nombre:"Colegio Norte",provincia:"Jaén",tipo:"Público",ciudad:"Linares",telefono:"953 456 654",logo:"https://images.unsplash.com/photo-1523240795612-9a054b0db644?w=400&h=300&fit=crop",resumen:"Programas deportivos y convivencia."},{id:15,nombre:"Colegio Costa",provincia:"Huelva",tipo:"Concertado",ciudad:"Lepe",telefono:"959 567 543",logo:"https://images.unsplash.com/photo-1562774053-701939374585?w=400&h=300&fit=crop",resumen:"Formación profesional y FP dual."}];let t={q:"",provincia:"",tipo:"",page:1};const o=document.getElementById("resultados"),n=document.getElementById("buscar"),a=document.getElementById("filtroProvincia"),i=document.getElementById("filtroTipo"),d=document.getElementById("btnLimpiar"),l=document.getElementById("prevPage"),r=document.getElementById("nextPage"),c=document.getElementById("pageInfo"),s=document.getElementById("modalOverlay"),m=document.getElementById("modalCloseBtn"),u=document.getElementById("modalTitle"),p=document.getElementById("modalLogo"),g=document.getElementById("modalProvinciaTipo"),v=document.getElementById("modalCiudad"),f=document.getElementById("modalDescripcion"),b=document.getElementById("modalTelefono"),h=document.getElementById("modalContactBtn"),y=document.getElementById("modalGoPerfil");let E=null;function C(){o.setAttribute("aria-busy","true");const n=function(){const o=t.q.toLowerCase().trim();return e.filter((e=>(e.nombre+" "+e.ciudad+" "+e.resumen+" "+e.provincia).toLowerCase().includes(o)&&(!t.provincia||e.provincia===t.provincia)&&(!t.tipo||e.tipo===t.tipo)))}(),a=Math.max(1,Math.ceil(n.length/15));t.page=Math.min(t.page,a);const i=15*(t.page-1),d=n.slice(i,i+15);o.innerHTML=d.map((e=>`\n          <article class="colegio-card" role="article" aria-labelledby="colegio-${e.id}">\n            <div class="colegio-logo" style="background-image:url('${e.logo}')" role="img" aria-label="${e.nombre} logo"></div>\n            <div class="colegio-meta">\n              <h4 id="colegio-${e.id}">${e.nombre}</h4>\n              <p><strong>${e.ciudad}</strong> · ${e.provincia}</p>\n              <p>${e.resumen}</p>\n              <div class="colegio-badges"><span class="badge">${e.tipo}</span></div>\n            </div>\n            <div class="colegio-actions">\n              <button class="btn-outline btn-view" data-id="${e.id}" aria-label="Ver ficha de ${e.nombre}">Ver ficha</button>\n              <button class="btn-primary" data-contact="${e.id}">Contactar centro</button>\n            </div>\n          </article>\n        `)).join(""),c.textContent=`${t.page} / ${a}`,l.disabled=t.page<=1,r.disabled=t.page>=a,o.setAttribute("aria-busy","false")}function L(t,o){const n=e.find((e=>e.id===t));n&&(E=o||document.activeElement,u.textContent=n.nombre,p.style.backgroundImage=`url('${n.logo}')`,g.textContent=`${n.tipo} · ${n.provincia}`,v.textContent=`Ciudad: ${n.ciudad}`,f.textContent=n.resumen,b.textContent=`Teléfono: ${n.telefono}`,y.href=`./detalle-colegio.html?id=${n.id}`,h.onclick=()=>alert(`Solicitud de contacto enviada a ${n.nombre}. Tel: ${n.telefono}`),s.classList.add("open"),s.setAttribute("aria-hidden","false"),function(e){x=Array.from(e.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])')).filter((e=>null!==e.offsetParent)),x.length>0&&(B=x[0],$=x[x.length-1],B.focus());e.addEventListener("keydown",k)}(s))}function I(){s.classList.remove("open"),s.setAttribute("aria-hidden","true"),s.removeEventListener("keydown",k),x=[],B=$=null,E&&"function"==typeof E.focus&&E.focus()}s.addEventListener("click",(e=>{e.target===s&&I()})),m.addEventListener("click",I),document.addEventListener("keydown",(e=>{"Escape"===e.key&&s.classList.contains("open")&&I()}));let x=[],B=null,$=null;function k(e){"Tab"===e.key&&(0!==x.length?e.shiftKey?document.activeElement===B&&(e.preventDefault(),$.focus()):document.activeElement===$&&(e.preventDefault(),B.focus()):e.preventDefault())}n.addEventListener("input",(e=>{t.q=e.target.value,t.page=1,C()})),a.addEventListener("change",(e=>{t.provincia=e.target.value,t.page=1,C()})),i.addEventListener("change",(e=>{t.tipo=e.target.value,t.page=1,C()})),d.addEventListener("click",(()=>{n.value="",a.value="",i.value="",t.q="",t.provincia="",t.tipo="",t.page=1,C()})),l.addEventListener("click",(()=>{t.page>1&&(t.page--,C())})),r.addEventListener("click",(()=>{t.page++,C()})),o.addEventListener("click",(t=>{if(t.target.classList.contains("btn-view")){L(Number(t.target.dataset.id),t.target)}const o=t.target.closest("[data-contact]");if(o){const t=Number(o.dataset.contact),n=e.find((e=>e.id===t));n&&alert(`Solicitud de contacto enviada a ${n.nombre}. Teléfono: ${n.telefono}`)}})),C()}));